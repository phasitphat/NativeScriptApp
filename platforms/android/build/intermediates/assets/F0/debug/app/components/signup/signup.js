"use strict";
var core_1 = require("@angular/core");
var signup_services_1 = require("./signup.services");
var router_1 = require("@angular/router");
var md5_1 = require("ts-md5/dist/md5");
var serverurl_1 = require("./../serverurl"); // get server test
var SignupComponent = (function () {
    function SignupComponent(router, myService, server) {
        this.router = router;
        this.myService = myService;
        this.server = server;
        this.user = null;
        this.pass = null;
        this.repass = null;
        this.fname = null;
        this.lname = null;
        this.gender = null;
        this.age = null;
        this.tel = null;
        this.typeofphone = null;
        this.email = null;
        this.jobs = null;
        this.address = null;
        this.postcode = null;
        this.exist_username = [];
        this.i = 0;
        this.j = 0;
        this.k = 0;
        this.aldy = 0;
        // >> (hide)
        this.isItemVisible = false;
    }
    SignupComponent.prototype.ngOnInit = function () {
        this.extractData();
        // this.extractResponseInfo();
    };
    SignupComponent.prototype.extractData = function () {
        var _this = this;
        console.log("extractData");
        this.myService.getData()
            .subscribe(function (result) { return _this.onGetDataSuccess(result); }, function (error) { return _this.onGetDataError(error); });
    };
    SignupComponent.prototype.onGetDataSuccess = function (res) {
        console.log("onGetDataSuccess");
        for (var _i = 0, res_1 = res; _i < res_1.length; _i++) {
            var user = res_1[_i];
            this.exist_username[this.i] = user.username;
            console.log("Exist Username : " + this.exist_username[this.i]);
            this.i++;
        }
    };
    SignupComponent.prototype.onGetDataError = function (error) {
        var body = error.json() || "";
        var err = body.error || JSON.stringify(body);
        alert("Connection Error");
        console.log("onGetDataError: " + err);
    };
    /////////////////////////// POST /////////////////////////////////
    SignupComponent.prototype.makePostRequest = function () {
        var _this = this;
        this.user = this.user.toLowerCase();
        if (this.pass != this.repass) {
            alert("Re-Password is Incorrect");
            this.router.navigate(["signup"]);
        }
        else if (this.tel.length != 10) {
            alert("Phone Number is Incorrect");
            this.router.navigate(["signup"]);
        }
        else {
            var e = md5_1.Md5.hashStr(this.pass);
            console.log("makePostRequest");
            for (this.k = 0; this.k < this.exist_username.length; this.k++) {
                if (this.exist_username[this.k] == this.user) {
                    this.aldy = 1;
                    alert("Username is already");
                    this.k = this.exist_username.length;
                }
                else {
                    this.aldy = 2;
                }
            }
            if (this.aldy == 2) {
                this.myService
                    .postData({
                    username: this.user,
                    password: e,
                    first_name: this.fname,
                    last_name: this.lname,
                    gender: this.gender,
                    age: this.age,
                    tel: this.tel,
                    typeofphone: this.typeofphone,
                    email: this.email,
                    jobs: this.jobs,
                    address: this.address,
                    postcode: this.postcode,
                })
                    .subscribe(function (res) {
                    alert("Sign Up Success \nusername is " + _this.user);
                    console.log(JSON.stringify(res));
                    _this.isItemVisible = true;
                }, function (err) {
                    // alert("Sign Up Error");
                    alert("Sign Up Error\nPlease try again");
                    console.log("Error : " + JSON.stringify(err));
                });
            } // if
        } // else
    }; // makepost
    SignupComponent.prototype.back = function () {
        this.router.navigate(["/"]);
    };
    SignupComponent.prototype.submit = function () {
        if (this.user == null) {
            alert("Please Fill Username");
            this.router.navigate(["signup"]);
        }
        else if (this.pass == null) {
            alert("Please Fill Password");
            this.router.navigate(["signup"]);
        }
        else if (this.repass == null) {
            alert("Please Fill Re-Password");
            this.router.navigate(["signup"]);
        }
        else if (this.fname == null) {
            alert("Please Fill First Name");
            this.router.navigate(["signup"]);
        }
        else if (this.lname == null) {
            alert("Please Fill Last Name");
            this.router.navigate(["signup"]);
        }
        else if (this.tel == null) {
            alert("Please Fill Phone Number");
            this.router.navigate(["signup"]);
        }
        else if (this.email == null) {
            alert("Please Fill E-mail Address");
            this.router.navigate(["signup"]);
        }
        else if (this.address == null) {
            alert("Please Fill Address");
            this.router.navigate(["signup"]);
        }
        else if (this.postcode == null) {
            alert("Please Fill Postcode");
            this.router.navigate(["signup"]);
        }
        else {
            this.makePostRequest();
            this.router.navigate(["/"]);
        }
    };
    return SignupComponent;
}());
SignupComponent = __decorate([
    core_1.Component({
        selector: "signup",
        templateUrl: "./components/signup/signup.html",
        providers: [signup_services_1.MyHttpPostService, serverurl_1.ServerComponent]
    }),
    __metadata("design:paramtypes", [router_1.Router, signup_services_1.MyHttpPostService, serverurl_1.ServerComponent])
], SignupComponent);
exports.SignupComponent = SignupComponent;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2lnbnVwLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsic2lnbnVwLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxzQ0FBd0M7QUFDeEMscURBQXNEO0FBQ3RELDBDQUF1QztBQUN2Qyx1Q0FBc0M7QUFDdEMsNENBQWlELENBQUMsa0JBQWtCO0FBUXBFLElBQWEsZUFBZTtJQTBCM0IseUJBQTJCLE1BQWMsRUFBVSxTQUE0QixFQUFVLE1BQXVCO1FBQXJGLFdBQU0sR0FBTixNQUFNLENBQVE7UUFBVSxjQUFTLEdBQVQsU0FBUyxDQUFtQjtRQUFVLFdBQU0sR0FBTixNQUFNLENBQWlCO1FBekJ0RyxTQUFJLEdBQVcsSUFBSSxDQUFDO1FBQ3BCLFNBQUksR0FBVyxJQUFJLENBQUM7UUFDcEIsV0FBTSxHQUFXLElBQUksQ0FBQztRQUN0QixVQUFLLEdBQVcsSUFBSSxDQUFDO1FBQ3JCLFVBQUssR0FBVyxJQUFJLENBQUM7UUFDckIsV0FBTSxHQUFXLElBQUksQ0FBQztRQUN0QixRQUFHLEdBQVcsSUFBSSxDQUFDO1FBQ25CLFFBQUcsR0FBVyxJQUFJLENBQUM7UUFDbkIsZ0JBQVcsR0FBVyxJQUFJLENBQUM7UUFDM0IsVUFBSyxHQUFXLElBQUksQ0FBQztRQUNyQixTQUFJLEdBQVcsSUFBSSxDQUFDO1FBQ3BCLFlBQU8sR0FBVyxJQUFJLENBQUM7UUFDdkIsYUFBUSxHQUFXLElBQUksQ0FBQztRQUV4QixtQkFBYyxHQUFHLEVBQUUsQ0FBQztRQUNwQixNQUFDLEdBQVUsQ0FBQyxDQUFDO1FBQ2IsTUFBQyxHQUFVLENBQUMsQ0FBQztRQUNiLE1BQUMsR0FBVSxDQUFDLENBQUM7UUFFYixTQUFJLEdBQVUsQ0FBQyxDQUFDO1FBRXZCLFlBQVk7UUFDTCxrQkFBYSxHQUFZLEtBQUssQ0FBQztJQUd5RSxDQUFDO0lBRWhILGtDQUFRLEdBQVI7UUFDSSxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDbkIsOEJBQThCO0lBQ2xDLENBQUM7SUFFRCxx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RixJQUFJLENBQUMsZUFBZSxFQUFFLENBQUM7WUFDdkIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ2hDLENBQUM7SUFFTCxDQUFDO0lBQ0wsc0JBQUM7QUFBRCxDQUFDLEFBekxELElBeUxDO0FBekxZLGVBQWU7SUFOM0IsZ0JBQVMsQ0FBQztRQUNQLFFBQVEsRUFBRSxRQUFRO1FBQ2xCLFdBQVcsRUFBRSxpQ0FBaUM7UUFDOUMsU0FBUyxFQUFFLENBQUMsbUNBQWlCLEVBQUMsMkJBQWUsQ0FBQztLQUNqRCxDQUFDO3FDQTRCa0MsZUFBTSxFQUFxQixtQ0FBaUIsRUFBa0IsMkJBQWU7R0ExQnBHLGVBQWUsQ0F5TDNCO0FBekxZLDBDQUFlIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtDb21wb25lbnR9IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XG5pbXBvcnQgeyBNeUh0dHBQb3N0U2VydmljZSB9IGZyb20gXCIuL3NpZ251cC5zZXJ2aWNlc1wiO1xuaW1wb3J0IHtSb3V0ZXJ9IGZyb20gXCJAYW5ndWxhci9yb3V0ZXJcIjtcbmltcG9ydCB7IE1kNSB9IGZyb20gJ3RzLW1kNS9kaXN0L21kNSc7XG5pbXBvcnQgeyBTZXJ2ZXJDb21wb25lbnQgfSBmcm9tIFwiLi8uLi9zZXJ2ZXJ1cmxcIjsgLy8gZ2V0IHNlcnZlciB0ZXN0XG5cbkBDb21wb25lbnQoe1xuICAgIHNlbGVjdG9yOiBcInNpZ251cFwiLFxuICAgIHRlbXBsYXRlVXJsOiBcIi4vY29tcG9uZW50cy9zaWdudXAvc2lnbnVwLmh0bWxcIixcbiAgICBwcm92aWRlcnM6IFtNeUh0dHBQb3N0U2VydmljZSxTZXJ2ZXJDb21wb25lbnRdXG59KVxuXG5leHBvcnQgY2xhc3MgU2lnbnVwQ29tcG9uZW50IHtcbiAgICBwdWJsaWMgdXNlcjogc3RyaW5nID0gbnVsbDtcbiAgICBwdWJsaWMgcGFzczogc3RyaW5nID0gbnVsbDtcbiAgICBwdWJsaWMgcmVwYXNzOiBzdHJpbmcgPSBudWxsO1xuICAgIHB1YmxpYyBmbmFtZTogc3RyaW5nID0gbnVsbDtcbiAgICBwdWJsaWMgbG5hbWU6IHN0cmluZyA9IG51bGw7XG4gICAgcHVibGljIGdlbmRlcjogc3RyaW5nID0gbnVsbDtcbiAgICBwdWJsaWMgYWdlOiBzdHJpbmcgPSBudWxsO1xuICAgIHB1YmxpYyB0ZWw6IHN0cmluZyA9IG51bGw7XG4gICAgcHVibGljIHR5cGVvZnBob25lOiBzdHJpbmcgPSBudWxsO1xuICAgIHB1YmxpYyBlbWFpbDogc3RyaW5nID0gbnVsbDtcbiAgICBwdWJsaWMgam9iczogc3RyaW5nID0gbnVsbDtcbiAgICBwdWJsaWMgYWRkcmVzczogc3RyaW5nID0gbnVsbDtcbiAgICBwdWJsaWMgcG9zdGNvZGU6IHN0cmluZyA9IG51bGw7XG5cbiAgICBwdWJsaWMgZXhpc3RfdXNlcm5hbWUgPSBbXTtcbiAgICBwdWJsaWMgaTpudW1iZXIgPSAwO1xuICAgIHB1YmxpYyBqOm51bWJlciA9IDA7XG4gICAgcHVibGljIGs6bnVtYmVyID0gMDtcblxuICAgIHB1YmxpYyBhbGR5Om51bWJlciA9IDA7XG5cbiAgICAvLyA+PiAoaGlkZSlcbiAgICBwdWJsaWMgaXNJdGVtVmlzaWJsZTogYm9vbGVhbiA9IGZhbHNlO1xuXG5cblx0cHVibGljIGNvbnN0cnVjdG9yKHByaXZhdGUgcm91dGVyOiBSb3V0ZXIsIHByaXZhdGUgbXlTZXJ2aWNlOiBNeUh0dHBQb3N0U2VydmljZSwgcHJpdmF0ZSBzZXJ2ZXI6IFNlcnZlckNvbXBvbmVudCl7fVxuXG4gICAgbmdPbkluaXQoKSB7XG4gICAgICAgIHRoaXMuZXh0cmFjdERhdGEoKTtcbiAgICAgICAgLy8gdGhpcy5leHRyYWN0UmVzcG9uc2VJbmZvKCk7XG4gICAgfVxuXG4gICAgZXh0cmFjdERhdGEoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiZXh0cmFjdERhdGFcIik7XG4gICAgICAgIHRoaXMubXlTZXJ2aWNlLmdldERhdGEoKVxuICAgICAgICAgICAgLnN1YnNjcmliZShcbiAgICAgICAgICAgIChyZXN1bHQpID0+IHRoaXMub25HZXREYXRhU3VjY2VzcyhyZXN1bHQpLFxuICAgICAgICAgICAgKGVycm9yKSA9PiB0aGlzLm9uR2V0RGF0YUVycm9yKGVycm9yKVxuICAgICAgICAgICAgKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIG9uR2V0RGF0YVN1Y2Nlc3MocmVzKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwib25HZXREYXRhU3VjY2Vzc1wiKTtcblxuICAgICAgICBmb3IobGV0IHVzZXIgb2YgcmVzKXtcblxuICAgICAgICAgICAgdGhpcy5leGlzdF91c2VybmFtZVt0aGlzLmldID0gdXNlci51c2VybmFtZVxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJFeGlzdCBVc2VybmFtZSA6IFwiICsgdGhpcy5leGlzdF91c2VybmFtZVt0aGlzLmldKVxuICAgICAgICAgICAgdGhpcy5pKys7XG5cbiAgICAgICAgfVxuXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvbkdldERhdGFFcnJvcihlcnJvcjogUmVzcG9uc2UgfCBhbnkpIHtcbiAgICAgICAgY29uc3QgYm9keSA9IGVycm9yLmpzb24oKSB8fCBcIlwiO1xuICAgICAgICBjb25zdCBlcnIgPSBib2R5LmVycm9yIHx8IEpTT04uc3RyaW5naWZ5KGJvZHkpO1xuICAgICAgICBhbGVydChcIkNvbm5lY3Rpb24gRXJyb3JcIilcbiAgICAgICAgY29uc29sZS5sb2coXCJvbkdldERhdGFFcnJvcjogXCIgKyBlcnIpO1xuICAgIH1cblxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vIFBPU1QgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICBwcml2YXRlIG1ha2VQb3N0UmVxdWVzdCgpIHtcbiAgICAgICAgXG4gICAgICAgIHRoaXMudXNlciA9IHRoaXMudXNlci50b0xvd2VyQ2FzZSgpO1xuXG4gICAgICAgIGlmKHRoaXMucGFzcyAhPSB0aGlzLnJlcGFzcyl7XG4gICAgICAgICAgICBhbGVydChcIlJlLVBhc3N3b3JkIGlzIEluY29ycmVjdFwiKVxuICAgICAgICAgICAgdGhpcy5yb3V0ZXIubmF2aWdhdGUoW1wic2lnbnVwXCJdKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKHRoaXMudGVsLmxlbmd0aCAhPSAxMCl7XG4gICAgICAgICAgICBhbGVydChcIlBob25lIE51bWJlciBpcyBJbmNvcnJlY3RcIilcbiAgICAgICAgICAgIHRoaXMucm91dGVyLm5hdmlnYXRlKFtcInNpZ251cFwiXSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZXtcbiAgICAgICAgXG4gICAgICAgICAgICBsZXQgZSA9IE1kNS5oYXNoU3RyKHRoaXMucGFzcyk7XG4gICAgICAgICAgIFxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJtYWtlUG9zdFJlcXVlc3RcIik7XG5cbiAgICAgICAgICAgIGZvcih0aGlzLms9MCA7IHRoaXMuayA8IHRoaXMuZXhpc3RfdXNlcm5hbWUubGVuZ3RoIDsgdGhpcy5rKyspe1xuICAgICAgICAgICAgICAgIGlmKHRoaXMuZXhpc3RfdXNlcm5hbWVbdGhpcy5rXT09dGhpcy51c2VyKXtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hbGR5ID0gMTtcbiAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCJVc2VybmFtZSBpcyBhbHJlYWR5XCIpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmsgPSB0aGlzLmV4aXN0X3VzZXJuYW1lLmxlbmd0aDtcbiAgICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hbGR5ID0gMjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYodGhpcy5hbGR5ID09IDIpe1xuXG4gICAgICAgICAgICAgICAgdGhpcy5teVNlcnZpY2VcbiAgICAgICAgICAgICAgICAucG9zdERhdGEoeyBcbiAgICAgICAgICAgICAgICAgICAgdXNlcm5hbWU6IHRoaXMudXNlcixcbiAgICAgICAgICAgICAgICAgICAgcGFzc3dvcmQ6IGUsXG4gICAgICAgICAgICAgICAgICAgIGZpcnN0X25hbWU6IHRoaXMuZm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIGxhc3RfbmFtZTogdGhpcy5sbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgZ2VuZGVyOiB0aGlzLmdlbmRlcixcbiAgICAgICAgICAgICAgICAgICAgYWdlOiB0aGlzLmFnZSxcbiAgICAgICAgICAgICAgICAgICAgdGVsOiB0aGlzLnRlbCxcbiAgICAgICAgICAgICAgICAgICAgdHlwZW9mcGhvbmU6IHRoaXMudHlwZW9mcGhvbmUsXG4gICAgICAgICAgICAgICAgICAgIGVtYWlsOiB0aGlzLmVtYWlsLFxuICAgICAgICAgICAgICAgICAgICBqb2JzOiB0aGlzLmpvYnMsXG4gICAgICAgICAgICAgICAgICAgIGFkZHJlc3M6IHRoaXMuYWRkcmVzcyxcbiAgICAgICAgICAgICAgICAgICAgcG9zdGNvZGU6IHRoaXMucG9zdGNvZGUsXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuc3Vic2NyaWJlKHJlcyA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwiU2lnbiBVcCBTdWNjZXNzIFxcbnVzZXJuYW1lIGlzIFwiK3RoaXMudXNlcik7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KHJlcykpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmlzSXRlbVZpc2libGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZXJyPT57XG4gICAgICAgICAgICAgICAgICAgIC8vIGFsZXJ0KFwiU2lnbiBVcCBFcnJvclwiKTtcbiAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCJTaWduIFVwIEVycm9yXFxuUGxlYXNlIHRyeSBhZ2FpblwiKVxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkVycm9yIDogXCIrSlNPTi5zdHJpbmdpZnkoZXJyKSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IC8vIGlmXG4gICAgICAgIH0gLy8gZWxzZVxuICAgIH0gLy8gbWFrZXBvc3RcblxuICAgIHB1YmxpYyBiYWNrKCkge1xuICAgICAgICB0aGlzLnJvdXRlci5uYXZpZ2F0ZShbXCIvXCJdKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3VibWl0KCkge1xuICAgICAgICBpZih0aGlzLnVzZXIgPT0gbnVsbCl7XG4gICAgICAgICAgICBhbGVydChcIlBsZWFzZSBGaWxsIFVzZXJuYW1lXCIpXG4gICAgICAgICAgICB0aGlzLnJvdXRlci5uYXZpZ2F0ZShbXCJzaWdudXBcIl0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYodGhpcy5wYXNzID09IG51bGwpe1xuICAgICAgICAgICAgYWxlcnQoXCJQbGVhc2UgRmlsbCBQYXNzd29yZFwiKVxuICAgICAgICAgICAgdGhpcy5yb3V0ZXIubmF2aWdhdGUoW1wic2lnbnVwXCJdKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKHRoaXMucmVwYXNzID09IG51bGwpe1xuICAgICAgICAgICAgYWxlcnQoXCJQbGVhc2UgRmlsbCBSZS1QYXNzd29yZFwiKVxuICAgICAgICAgICAgdGhpcy5yb3V0ZXIubmF2aWdhdGUoW1wic2lnbnVwXCJdKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKHRoaXMuZm5hbWUgPT0gbnVsbCl7XG4gICAgICAgICAgICBhbGVydChcIlBsZWFzZSBGaWxsIEZpcnN0IE5hbWVcIilcbiAgICAgICAgICAgIHRoaXMucm91dGVyLm5hdmlnYXRlKFtcInNpZ251cFwiXSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZih0aGlzLmxuYW1lID09IG51bGwpe1xuICAgICAgICAgICAgYWxlcnQoXCJQbGVhc2UgRmlsbCBMYXN0IE5hbWVcIilcbiAgICAgICAgICAgIHRoaXMucm91dGVyLm5hdmlnYXRlKFtcInNpZ251cFwiXSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gZWxzZSBpZih0aGlzLmdlbmRlciA9PSBudWxsKXtcbiAgICAgICAgLy8gICAgIGFsZXJ0KFwiUGxlYXNlIEZpbGwgR2VuZGVyXCIpXG4gICAgICAgIC8vICAgICB0aGlzLnJvdXRlci5uYXZpZ2F0ZShbXCJzaWdudXBcIl0pO1xuICAgICAgICAvLyB9XG4gICAgICAgIC8vIGVsc2UgaWYodGhpcy5hZ2UgPT0gbnVsbCl7XG4gICAgICAgIC8vICAgICBhbGVydChcIlBsZWFzZSBGaWxsIEFnZVwiKVxuICAgICAgICAvLyAgICAgdGhpcy5yb3V0ZXIubmF2aWdhdGUoW1wic2lnbnVwXCJdKTtcbiAgICAgICAgLy8gfVxuICAgICAgICBlbHNlIGlmKHRoaXMudGVsID09IG51bGwpe1xuICAgICAgICAgICAgYWxlcnQoXCJQbGVhc2UgRmlsbCBQaG9uZSBOdW1iZXJcIilcbiAgICAgICAgICAgIHRoaXMucm91dGVyLm5hdmlnYXRlKFtcInNpZ251cFwiXSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gZWxzZSBpZih0aGlzLnR5cGVvZnBob25lID09IG51bGwpe1xuICAgICAgICAvLyAgICAgYWxlcnQoXCJQbGVhc2UgRmlsbCBUeXBlIG9mIFBob25lIChJT1MvQU5EUk9JRClcIilcbiAgICAgICAgLy8gICAgIHRoaXMucm91dGVyLm5hdmlnYXRlKFtcInNpZ251cFwiXSk7XG4gICAgICAgIC8vIH1cbiAgICAgICAgZWxzZSBpZih0aGlzLmVtYWlsID09IG51bGwpe1xuICAgICAgICAgICAgYWxlcnQoXCJQbGVhc2UgRmlsbCBFLW1haWwgQWRkcmVzc1wiKVxuICAgICAgICAgICAgdGhpcy5yb3V0ZXIubmF2aWdhdGUoW1wic2lnbnVwXCJdKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBlbHNlIGlmKHRoaXMuam9icyA9PSBudWxsKXtcbiAgICAgICAgLy8gICAgIGFsZXJ0KFwiUGxlYXNlIEZpbGwgSm9ic1wiKVxuICAgICAgICAvLyAgICAgdGhpcy5yb3V0ZXIubmF2aWdhdGUoW1wic2lnbnVwXCJdKTtcbiAgICAgICAgLy8gfVxuICAgICAgICBlbHNlIGlmKHRoaXMuYWRkcmVzcyA9PSBudWxsKXtcbiAgICAgICAgICAgIGFsZXJ0KFwiUGxlYXNlIEZpbGwgQWRkcmVzc1wiKVxuICAgICAgICAgICAgdGhpcy5yb3V0ZXIubmF2aWdhdGUoW1wic2lnbnVwXCJdKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKHRoaXMucG9zdGNvZGUgPT0gbnVsbCl7XG4gICAgICAgICAgICBhbGVydChcIlBsZWFzZSBGaWxsIFBvc3Rjb2RlXCIpXG4gICAgICAgICAgICB0aGlzLnJvdXRlci5uYXZpZ2F0ZShbXCJzaWdudXBcIl0pO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIHRoaXMubWFrZVBvc3RSZXF1ZXN0KCk7XG4gICAgICAgICAgICB0aGlzLnJvdXRlci5uYXZpZ2F0ZShbXCIvXCJdKTsgXG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgfVxufVxuIl19