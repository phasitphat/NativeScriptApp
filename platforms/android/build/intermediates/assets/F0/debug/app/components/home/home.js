"use strict";
var core_1 = require("@angular/core");
var router_1 = require("@angular/router");
var home_services_1 = require("./home.services");
var serverurl_1 = require("./../serverurl"); // get server test
// import * as observable from 'data/observable';
// import * as pages from 'ui/page';
// import {HelloWorldModel} from './main-view-model';
var LocalStorage = require("nativescript-localstorage");
var HomeComponent = (function () {
    function HomeComponent(router, myService, server) {
        this.router = router;
        this.myService = myService;
        this.server = server;
        this.new_product_id = [];
        this.new_product_name = [];
        this.new_product_price = [];
        this.new_product_image = [];
        this.random_product_id = [];
        this.random_product_image = [];
        this.i = 0;
        this.count = 0;
        this.myItems = [];
        this.localid = LocalStorage.getItem("customer_id");
    }
    HomeComponent.prototype.ngOnInit = function () {
        this.extractDataRandom();
        this.extractDataOrder();
        this.extractDataNew();
    };
    HomeComponent.prototype.extractDataRandom = function () {
        var _this = this;
        console.log("getDataRandom");
        this.myService.getDataRandom()
            .subscribe(function (result) { return _this.onGetDataSuccessRandom(result); }, function (error) { return _this.onGetDataError(error); });
    };
    HomeComponent.prototype.extractDataOrder = function () {
        var _this = this;
        console.log("getDataOrder");
        this.myService.getDataOrder()
            .subscribe(function (result) { return _this.onGetDataSuccessOrder(result); }, function (error) { return _this.onGetDataError(error); });
    };
    HomeComponent.prototype.extractDataNew = function () {
        var _this = this;
        console.log("getDataNew");
        this.myService.getDataNew()
            .subscribe(function (result) { return _this.onGetDataSuccess_new(result); }, function (error) { return _this.onGetDataError(error); });
    };
    HomeComponent.prototype.extractDataSearch = function () {
        var _this = this;
        console.log("getDataSearch");
        this.myService.getDataRandom()
            .subscribe(function (result) { return _this.onGetDataSuccessSearch(result); }, function (error) { return _this.onGetDataError(error); });
    };
    HomeComponent.prototype.onGetDataSuccessRandom = function (res) {
        console.log("Push Items for Search");
        console.log("onGetDataSuccess_Random");
        this.ran1 = Math.floor(Math.random() * res.length) + 1;
        this.ran2 = Math.floor(Math.random() * res.length) + 1;
        this.ran3 = Math.floor(Math.random() * res.length) + 1;
        this.ran4 = Math.floor(Math.random() * res.length) + 1;
        this.ran5 = Math.floor(Math.random() * res.length) + 1;
        this.ran6 = Math.floor(Math.random() * res.length) + 1;
        this.ran7 = Math.floor(Math.random() * res.length) + 1;
        this.ran8 = Math.floor(Math.random() * res.length) + 1;
        this.ran9 = Math.floor(Math.random() * res.length) + 1;
        this.ran10 = Math.floor(Math.random() * res.length) + 1;
        for (var _i = 0, res_1 = res; _i < res_1.length; _i++) {
            var product = res_1[_i];
            if (this.myItems.length != res.length) {
                this.myItems.push(product.product_name.toLowerCase());
            }
            if (product.id == this.ran1) {
                this.random_product_id[0] = product.id;
                this.random_product_image[0] = product.product_image;
            }
            if (product.id == this.ran2) {
                this.random_product_id[1] = product.id;
                this.random_product_image[1] = product.product_image;
            }
            if (product.id == this.ran3) {
                this.random_product_id[2] = product.id;
                this.random_product_image[2] = product.product_image;
            }
            if (product.id == this.ran4) {
                this.random_product_id[3] = product.id;
                this.random_product_image[3] = product.product_image;
            }
            if (product.id == this.ran5) {
                this.random_product_id[4] = product.id;
                this.random_product_image[4] = product.product_image;
            }
            if (product.id == this.ran6) {
                this.random_product_id[5] = product.id;
                this.random_product_image[5] = product.product_image;
            }
            if (product.id == this.ran7) {
                this.random_product_id[6] = product.id;
                this.random_product_image[6] = product.product_image;
            }
            if (product.id == this.ran8) {
                this.random_product_id[7] = product.id;
                this.random_product_image[7] = product.product_image;
            }
            if (product.id == this.ran9) {
                this.random_product_id[8] = product.id;
                this.random_product_image[8] = product.product_image;
            }
            if (product.id == this.ran10) {
                this.random_product_id[9] = product.id;
                this.random_product_image[9] = product.product_image;
            }
        }
    };
    HomeComponent.prototype.onGetDataSuccessOrder = function (res) {
        console.log("onGetDataSuccess_Order");
        for (var _i = 0, res_2 = res; _i < res_2.length; _i++) {
            var order = res_2[_i];
            console.log("Order In Home : " + order.customer);
            if (order.customer == this.localid) {
                console.log("Order at home : " + order.customer);
                console.log("Order id : " + order.id);
                LocalStorage.setItem("order_id", order.id);
            }
        }
    };
    HomeComponent.prototype.onGetDataSuccess_new = function (res) {
        console.log("onGetDataSuccess_new_release");
        for (var _i = 0, res_3 = res; _i < res_3.length; _i++) {
            var product = res_3[_i];
            if (this.i < 10) {
                this.new_product_id[this.i] = product.id;
                this.new_product_name[this.i] = product.product_name;
                this.new_product_price[this.i] = product.product_price;
                this.new_product_image[this.i] = product.product_image;
                // console.log("New Product id : "+ product.id)
                // console.log("New Product image : "+product.product_image)
                this.i += 1;
            }
        }
    };
    HomeComponent.prototype.onGetDataSuccessSearch = function (res) {
        this.localsearch = LocalStorage.getItem("localsearch");
        for (var _i = 0, res_4 = res; _i < res_4.length; _i++) {
            var product = res_4[_i];
            if (product.product_name.toLowerCase() == this.localsearch) {
                this.router.navigate(["product/", product.id]);
            }
        }
    };
    HomeComponent.prototype.onGetDataError = function (error) {
        var body = error.json() || "";
        var err = body.error || JSON.stringify(body);
        console.log("onGetDataError: " + err);
    };
    HomeComponent.prototype.cart = function () {
        this.router.navigate(["cart"]); // come from path in routing ts
    };
    HomeComponent.prototype.menu = function () {
        this.router.navigate(["menu"]); // come from path in routing ts
    };
    HomeComponent.prototype.product = function (product_id) {
        if (product_id === void 0) { product_id = 0; }
        // let navigationExtras: NavigationExtras = {
        //     queryParams: {
        //         "id": product_id
        //     }
        // };
        // console.log(JSON.stringify(navigationExtras));
        // this.router.navigate(["product/"], navigationExtras);
        this.router.navigate(["product/", product_id]);
        // this.router.navigateByUrl('product/' + product_id);       
    };
    HomeComponent.prototype.onSubmit = function (value) {
        // alert("You are searching for " + value);
        // for(var _i = 0; _i < this.myItems.length; _i++){
        var x = 0;
        var out = 0;
        console.log("Search : " + value);
        console.log("this.myItems.length : " + this.myItems.length);
        for (this.count = 0; this.count < this.myItems.length; this.count++) {
            // console.log("count : "+this.count)
            x += 1;
            if (this.myItems[this.count].toLowerCase() == value.toLowerCase()) {
                console.log("Search : " + value);
                LocalStorage.setItem("localsearch", value.toLowerCase());
                this.extractDataSearch();
                out = 1;
            }
            if (out == 0 && x + 1 > this.myItems.length) {
                console.log("x : " + x);
                console.log("this.myItems.length : " + this.myItems.length);
                alert("No Product Name : " + value);
            }
        }
    };
    HomeComponent.prototype.onSearchLayoutLoaded = function (event) {
        event.object.android.setFocusableInTouchMode(true);
    };
    HomeComponent.prototype.onSearchBarLoaded = function (event) {
        event.object.android.clearFocus();
    };
    HomeComponent.prototype.clearTextfieldFocus = function (event) {
        event.layout.android.dismissSoftInput();
    };
    return HomeComponent;
}());
HomeComponent = __decorate([
    core_1.Component({
        selector: "home",
        templateUrl: "./components/home/home.html",
        providers: [home_services_1.MyHttpGetService, serverurl_1.ServerComponent]
    }),
    __metadata("design:paramtypes", [router_1.Router, home_services_1.MyHttpGetService, serverurl_1.ServerComponent])
], HomeComponent);
exports.HomeComponent = HomeComponent;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaG9tZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImhvbWUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLHNDQUEwQztBQUMxQywwQ0FBMkQ7QUFDM0QsaURBQW1EO0FBQ25ELDRDQUFpRCxDQUFDLGtCQUFrQjtBQUNwRSxpREFBaUQ7QUFDakQsb0NBQW9DO0FBQ3BDLHFEQUFxRDtBQUVyRCxJQUFJLFlBQVksR0FBRyxPQUFPLENBQUUsMkJBQTJCLENBQUUsQ0FBQztBQVMxRCxJQUFhLGFBQWE7SUFrQ3RCLHVCQUEyQixNQUFjLEVBQVUsU0FBMkIsRUFBVSxNQUF1QjtRQUFwRixXQUFNLEdBQU4sTUFBTSxDQUFRO1FBQVUsY0FBUyxHQUFULFNBQVMsQ0FBa0I7UUFBVSxXQUFNLEdBQU4sTUFBTSxDQUFpQjtRQXhCeEcsbUJBQWMsR0FBRyxFQUFFLENBQUM7UUFDcEIscUJBQWdCLEdBQUcsRUFBRSxDQUFDO1FBQ3RCLHNCQUFpQixHQUFHLEVBQUUsQ0FBQztRQUN2QixzQkFBaUIsR0FBRyxFQUFFLENBQUM7UUFFdkIsc0JBQWlCLEdBQUcsRUFBRSxDQUFDO1FBQ3ZCLHlCQUFvQixHQUFHLEVBQUUsQ0FBQztRQWExQixNQUFDLEdBQVUsQ0FBQyxDQUFDO1FBQ2IsVUFBSyxHQUFVLENBQUMsQ0FBQztRQUVqQixZQUFPLEdBQU8sRUFBRSxDQUFDO1FBSXBCLElBQUksQ0FBQyxPQUFPLEdBQUcsWUFBWSxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMsQ0FBQztJQUV2RCxDQUFDO0lBR0QsZ0NBQVEsR0FBUjtRQUVJLElBQUksQ0FBQyxpQkFBaUIsRUFBRSxDQUFDO1FBQ3pCLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1FBQ3hCLElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQztJQUUxQixDQUFDO0lBRUQseUNBQWlCLEdBQWpCO1FBQUEsaUJBT0M7UUFORyxPQUFPLENBQUMsR0FBRyxDQUFDLGVBQWUsQ0FBQyxDQUFDO1FBQzdCLElBQUksQ0FB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Q0FxQ3FDLGVBQU0sRUFBcUIsZ0NBQWdCLEVBQWtCLDJCQUFlO0dBbEN0RyxhQUFhLENBaVN6QjtBQWpTWSxzQ0FBYSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XG5pbXBvcnQgeyBSb3V0ZXIsIE5hdmlnYXRpb25FeHRyYXMgfSBmcm9tIFwiQGFuZ3VsYXIvcm91dGVyXCI7XG5pbXBvcnQgeyBNeUh0dHBHZXRTZXJ2aWNlIH0gZnJvbSBcIi4vaG9tZS5zZXJ2aWNlc1wiO1xuaW1wb3J0IHsgU2VydmVyQ29tcG9uZW50IH0gZnJvbSBcIi4vLi4vc2VydmVydXJsXCI7IC8vIGdldCBzZXJ2ZXIgdGVzdFxuLy8gaW1wb3J0ICogYXMgb2JzZXJ2YWJsZSBmcm9tICdkYXRhL29ic2VydmFibGUnO1xuLy8gaW1wb3J0ICogYXMgcGFnZXMgZnJvbSAndWkvcGFnZSc7XG4vLyBpbXBvcnQge0hlbGxvV29ybGRNb2RlbH0gZnJvbSAnLi9tYWluLXZpZXctbW9kZWwnO1xuXG5sZXQgTG9jYWxTdG9yYWdlID0gcmVxdWlyZSggXCJuYXRpdmVzY3JpcHQtbG9jYWxzdG9yYWdlXCIgKTtcblxuQENvbXBvbmVudCh7XG4gICAgc2VsZWN0b3I6IFwiaG9tZVwiLFxuICAgIHRlbXBsYXRlVXJsOiBcIi4vY29tcG9uZW50cy9ob21lL2hvbWUuaHRtbFwiLFxuICAgIHByb3ZpZGVyczogW015SHR0cEdldFNlcnZpY2UsU2VydmVyQ29tcG9uZW50XVxufSlcblxuXG5leHBvcnQgY2xhc3MgSG9tZUNvbXBvbmVudHtcblxuICAgIC8vIHB1YmxpYyBwcm9kdWN0czogT2JzZXJ2YWJsZUFycmF5PGFueT47XG4gICAgcHVibGljIGxvY2FsaWQ6IHN0cmluZztcbiAgICBwdWJsaWMgbG9jYWxzZWFyY2g6IHN0cmluZzsgXG5cbiAgICBwdWJsaWMgcHJvZHVjdF9pZDogc3RyaW5nO1xuICAgIHB1YmxpYyBwcm9kdWN0X3F1YW50aXR5OiBudW1iZXI7XG4gICAgcHVibGljIHByb2R1Y3RfZGV0YWlsOiBzdHJpbmc7XG5cbiAgICBwdWJsaWMgbmV3X3Byb2R1Y3RfaWQgPSBbXTtcbiAgICBwdWJsaWMgbmV3X3Byb2R1Y3RfbmFtZSA9IFtdO1xuICAgIHB1YmxpYyBuZXdfcHJvZHVjdF9wcmljZSA9IFtdO1xuICAgIHB1YmxpYyBuZXdfcHJvZHVjdF9pbWFnZSA9IFtdO1xuXG4gICAgcHVibGljIHJhbmRvbV9wcm9kdWN0X2lkID0gW107XG4gICAgcHVibGljIHJhbmRvbV9wcm9kdWN0X2ltYWdlID0gW107XG5cbiAgICBwdWJsaWMgcmFuMTpudW1iZXI7XG4gICAgcHVibGljIHJhbjI6bnVtYmVyO1xuICAgIHB1YmxpYyByYW4zOm51bWJlcjtcbiAgICBwdWJsaWMgcmFuNDpudW1iZXI7XG4gICAgcHVibGljIHJhbjU6bnVtYmVyO1xuICAgIHB1YmxpYyByYW42Om51bWJlcjtcbiAgICBwdWJsaWMgcmFuNzpudW1iZXI7XG4gICAgcHVibGljIHJhbjg6bnVtYmVyO1xuICAgIHB1YmxpYyByYW45Om51bWJlcjtcbiAgICBwdWJsaWMgcmFuMTA6bnVtYmVyO1xuXG4gICAgcHVibGljIGk6bnVtYmVyID0gMDtcbiAgICBwdWJsaWMgY291bnQ6bnVtYmVyID0gMDtcblxuICAgIHB1YmxpYyBteUl0ZW1zOmFueSA9IFtdO1xuXG4gICAgcHVibGljIGNvbnN0cnVjdG9yKHByaXZhdGUgcm91dGVyOiBSb3V0ZXIsIHByaXZhdGUgbXlTZXJ2aWNlOiBNeUh0dHBHZXRTZXJ2aWNlLCBwcml2YXRlIHNlcnZlcjogU2VydmVyQ29tcG9uZW50KXtcblxuICAgICAgICB0aGlzLmxvY2FsaWQgPSBMb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImN1c3RvbWVyX2lkXCIpO1xuXG4gICAgfVxuICAgIFxuICAgIFxuICAgIG5nT25Jbml0KCkge1xuXG4gICAgICAgIHRoaXMuZXh0cmFjdERhdGFSYW5kb20oKTtcbiAgICAgICAgdGhpcy5leHRyYWN0RGF0YU9yZGVyKCk7XG4gICAgICAgIHRoaXMuZXh0cmFjdERhdGFOZXcoKTtcbiAgICAgICAgXG4gICAgfVxuXG4gICAgZXh0cmFjdERhdGFSYW5kb20oKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiZ2V0RGF0YVJhbmRvbVwiKTtcbiAgICAgICAgdGhpcy5teVNlcnZpY2UuZ2V0RGF0YVJhbmRvbSgpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKFxuICAgICAgICAgICAgKHJlc3VsdCkgPT4gdGhpcy5vbkdldERhdGFTdWNjZXNzUmFuZG9tKHJlc3VsdCksXG4gICAgICAgICAgICAoZXJyb3IpID0+IHRoaXMub25HZXREYXRhRXJyb3IoZXJyb3IpXG4gICAgICAgICAgICApO1xuICAgIH1cblxuICAgIGV4dHJhY3REYXRhT3JkZXIoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiZ2V0RGF0YU9yZGVyXCIpO1xuICAgICAgICB0aGlzLm15U2VydmljZS5nZXREYXRhT3JkZXIoKVxuICAgICAgICAgICAgLnN1YnNjcmliZShcbiAgICAgICAgICAgIChyZXN1bHQpID0+IHRoaXMub25HZXREYXRhU3VjY2Vzc09yZGVyKHJlc3VsdCksXG4gICAgICAgICAgICAoZXJyb3IpID0+IHRoaXMub25HZXREYXRhRXJyb3IoZXJyb3IpXG4gICAgICAgICAgICApO1xuICAgIH1cblxuICAgIGV4dHJhY3REYXRhTmV3KCkge1xuICAgICAgICBjb25zb2xlLmxvZyhcImdldERhdGFOZXdcIik7XG4gICAgICAgIHRoaXMubXlTZXJ2aWNlLmdldERhdGFOZXcoKVxuICAgICAgICAgICAgLnN1YnNjcmliZShcbiAgICAgICAgICAgIChyZXN1bHQpID0+IHRoaXMub25HZXREYXRhU3VjY2Vzc19uZXcocmVzdWx0KSxcbiAgICAgICAgICAgIChlcnJvcikgPT4gdGhpcy5vbkdldERhdGFFcnJvcihlcnJvcilcbiAgICAgICAgICAgICk7XG4gICAgfVxuXG4gICAgZXh0cmFjdERhdGFTZWFyY2goKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiZ2V0RGF0YVNlYXJjaFwiKTtcbiAgICAgICAgdGhpcy5teVNlcnZpY2UuZ2V0RGF0YVJhbmRvbSgpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKFxuICAgICAgICAgICAgKHJlc3VsdCkgPT4gdGhpcy5vbkdldERhdGFTdWNjZXNzU2VhcmNoKHJlc3VsdCksXG4gICAgICAgICAgICAoZXJyb3IpID0+IHRoaXMub25HZXREYXRhRXJyb3IoZXJyb3IpXG4gICAgICAgICAgICApO1xuICAgIH1cblxuICAgIHByaXZhdGUgb25HZXREYXRhU3VjY2Vzc1JhbmRvbShyZXMpIHtcblxuICAgICAgICBjb25zb2xlLmxvZyhcIlB1c2ggSXRlbXMgZm9yIFNlYXJjaFwiKVxuICAgICAgICBcbiAgICAgICAgY29uc29sZS5sb2coXCJvbkdldERhdGFTdWNjZXNzX1JhbmRvbVwiKVxuXG4gICAgICAgIHRoaXMucmFuMSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHJlcy5sZW5ndGgpICsgMTtcbiAgICAgICAgdGhpcy5yYW4yID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogcmVzLmxlbmd0aCkgKyAxO1xuICAgICAgICB0aGlzLnJhbjMgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiByZXMubGVuZ3RoKSArIDE7XG4gICAgICAgIHRoaXMucmFuNCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHJlcy5sZW5ndGgpICsgMTtcbiAgICAgICAgdGhpcy5yYW41ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogcmVzLmxlbmd0aCkgKyAxO1xuICAgICAgICB0aGlzLnJhbjYgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiByZXMubGVuZ3RoKSArIDE7XG4gICAgICAgIHRoaXMucmFuNyA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHJlcy5sZW5ndGgpICsgMTtcbiAgICAgICAgdGhpcy5yYW44ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogcmVzLmxlbmd0aCkgKyAxO1xuICAgICAgICB0aGlzLnJhbjkgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiByZXMubGVuZ3RoKSArIDE7XG4gICAgICAgIHRoaXMucmFuMTAgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiByZXMubGVuZ3RoKSArIDE7XG5cbiAgICAgICAgZm9yIChsZXQgcHJvZHVjdCBvZiByZXMpIHtcblxuICAgICAgICAgICAgICAgIGlmKHRoaXMubXlJdGVtcy5sZW5ndGggIT0gcmVzLmxlbmd0aCl7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubXlJdGVtcy5wdXNoKHByb2R1Y3QucHJvZHVjdF9uYW1lLnRvTG93ZXJDYXNlKCkpXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYocHJvZHVjdC5pZCA9PSB0aGlzLnJhbjEpe1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJhbmRvbV9wcm9kdWN0X2lkWzBdID0gcHJvZHVjdC5pZDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yYW5kb21fcHJvZHVjdF9pbWFnZVswXSA9IHByb2R1Y3QucHJvZHVjdF9pbWFnZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYocHJvZHVjdC5pZCA9PSB0aGlzLnJhbjIpe1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJhbmRvbV9wcm9kdWN0X2lkWzFdID0gcHJvZHVjdC5pZDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yYW5kb21fcHJvZHVjdF9pbWFnZVsxXSA9IHByb2R1Y3QucHJvZHVjdF9pbWFnZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYocHJvZHVjdC5pZCA9PSB0aGlzLnJhbjMpe1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJhbmRvbV9wcm9kdWN0X2lkWzJdID0gcHJvZHVjdC5pZDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yYW5kb21fcHJvZHVjdF9pbWFnZVsyXSA9IHByb2R1Y3QucHJvZHVjdF9pbWFnZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYocHJvZHVjdC5pZCA9PSB0aGlzLnJhbjQpe1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJhbmRvbV9wcm9kdWN0X2lkWzNdID0gcHJvZHVjdC5pZDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yYW5kb21fcHJvZHVjdF9pbWFnZVszXSA9IHByb2R1Y3QucHJvZHVjdF9pbWFnZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYocHJvZHVjdC5pZCA9PSB0aGlzLnJhbjUpe1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJhbmRvbV9wcm9kdWN0X2lkWzRdID0gcHJvZHVjdC5pZDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yYW5kb21fcHJvZHVjdF9pbWFnZVs0XSA9IHByb2R1Y3QucHJvZHVjdF9pbWFnZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYocHJvZHVjdC5pZCA9PSB0aGlzLnJhbjYpe1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJhbmRvbV9wcm9kdWN0X2lkWzVdID0gcHJvZHVjdC5pZDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yYW5kb21fcHJvZHVjdF9pbWFnZVs1XSA9IHByb2R1Y3QucHJvZHVjdF9pbWFnZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYocHJvZHVjdC5pZCA9PSB0aGlzLnJhbjcpe1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJhbmRvbV9wcm9kdWN0X2lkWzZdID0gcHJvZHVjdC5pZDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yYW5kb21fcHJvZHVjdF9pbWFnZVs2XSA9IHByb2R1Y3QucHJvZHVjdF9pbWFnZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYocHJvZHVjdC5pZCA9PSB0aGlzLnJhbjgpe1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJhbmRvbV9wcm9kdWN0X2lkWzddID0gcHJvZHVjdC5pZDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yYW5kb21fcHJvZHVjdF9pbWFnZVs3XSA9IHByb2R1Y3QucHJvZHVjdF9pbWFnZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYocHJvZHVjdC5pZCA9PSB0aGlzLnJhbjkpe1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJhbmRvbV9wcm9kdWN0X2lkWzhdID0gcHJvZHVjdC5pZDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yYW5kb21fcHJvZHVjdF9pbWFnZVs4XSA9IHByb2R1Y3QucHJvZHVjdF9pbWFnZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYocHJvZHVjdC5pZCA9PSB0aGlzLnJhbjEwKXtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yYW5kb21fcHJvZHVjdF9pZFs5XSA9IHByb2R1Y3QuaWQ7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmFuZG9tX3Byb2R1Y3RfaW1hZ2VbOV0gPSBwcm9kdWN0LnByb2R1Y3RfaW1hZ2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICBcbiAgICAgICAgfVxuXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvbkdldERhdGFTdWNjZXNzT3JkZXIocmVzKSB7XG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLmxvZyhcIm9uR2V0RGF0YVN1Y2Nlc3NfT3JkZXJcIik7XG5cbiAgICAgICAgZm9yIChsZXQgb3JkZXIgb2YgcmVzKSB7XG5cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiT3JkZXIgSW4gSG9tZSA6IFwiICsgb3JkZXIuY3VzdG9tZXIpXG5cbiAgICAgICAgICAgICAgICBpZihvcmRlci5jdXN0b21lciA9PSB0aGlzLmxvY2FsaWQpe1xuXG4gICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk9yZGVyIGF0IGhvbWUgOiBcIiArIG9yZGVyLmN1c3RvbWVyKVxuICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJPcmRlciBpZCA6IFwiICsgb3JkZXIuaWQpXG4gICAgICAgICAgICAgICAgICAgICBMb2NhbFN0b3JhZ2Uuc2V0SXRlbShcIm9yZGVyX2lkXCIsIG9yZGVyLmlkKVxuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICB9XG5cbiAgICBwcml2YXRlIG9uR2V0RGF0YVN1Y2Nlc3NfbmV3KHJlcykge1xuICAgICAgICBcbiAgICAgICAgY29uc29sZS5sb2coXCJvbkdldERhdGFTdWNjZXNzX25ld19yZWxlYXNlXCIpO1xuXG4gICAgICAgIGZvciAobGV0IHByb2R1Y3Qgb2YgcmVzKSB7XG5cbiAgICAgICAgICAgIGlmKHRoaXMuaSA8IDEwKXtcblxuICAgICAgICAgICAgICAgIHRoaXMubmV3X3Byb2R1Y3RfaWRbdGhpcy5pXSA9IHByb2R1Y3QuaWQ7XG4gICAgICAgICAgICAgICAgdGhpcy5uZXdfcHJvZHVjdF9uYW1lW3RoaXMuaV0gPSBwcm9kdWN0LnByb2R1Y3RfbmFtZTtcbiAgICAgICAgICAgICAgICB0aGlzLm5ld19wcm9kdWN0X3ByaWNlW3RoaXMuaV0gPSBwcm9kdWN0LnByb2R1Y3RfcHJpY2U7XG4gICAgICAgICAgICAgICAgdGhpcy5uZXdfcHJvZHVjdF9pbWFnZVt0aGlzLmldID0gcHJvZHVjdC5wcm9kdWN0X2ltYWdlO1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiTmV3IFByb2R1Y3QgaWQgOiBcIisgcHJvZHVjdC5pZClcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcIk5ldyBQcm9kdWN0IGltYWdlIDogXCIrcHJvZHVjdC5wcm9kdWN0X2ltYWdlKVxuXG4gICAgICAgICAgICAgICAgdGhpcy5pICs9IDFcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgfVxuXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvbkdldERhdGFTdWNjZXNzU2VhcmNoKHJlcykge1xuXG4gICAgICAgIHRoaXMubG9jYWxzZWFyY2ggPSBMb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImxvY2Fsc2VhcmNoXCIpO1xuXG4gICAgICAgIGZvciAobGV0IHByb2R1Y3Qgb2YgcmVzKSB7XG5cbiAgICAgICAgICAgIGlmKHByb2R1Y3QucHJvZHVjdF9uYW1lLnRvTG93ZXJDYXNlKCkgPT0gdGhpcy5sb2NhbHNlYXJjaCl7XG4gICAgICAgICAgICAgICAgdGhpcy5yb3V0ZXIubmF2aWdhdGUoW1wicHJvZHVjdC9cIixwcm9kdWN0LmlkXSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvbkdldERhdGFFcnJvcihlcnJvcjogUmVzcG9uc2UgfCBhbnkpIHtcbiAgICAgICAgY29uc3QgYm9keSA9IGVycm9yLmpzb24oKSB8fCBcIlwiO1xuICAgICAgICBjb25zdCBlcnIgPSBib2R5LmVycm9yIHx8IEpTT04uc3RyaW5naWZ5KGJvZHkpO1xuICAgICAgICBjb25zb2xlLmxvZyhcIm9uR2V0RGF0YUVycm9yOiBcIiArIGVycik7XG4gICAgfVxuXG5cdHB1YmxpYyBjYXJ0KCl7XG5cdFx0dGhpcy5yb3V0ZXIubmF2aWdhdGUoW1wiY2FydFwiXSk7ICAgICAgICAgIC8vIGNvbWUgZnJvbSBwYXRoIGluIHJvdXRpbmcgdHNcblx0fVxuXG5cdHB1YmxpYyBtZW51KCl7XG5cdFx0dGhpcy5yb3V0ZXIubmF2aWdhdGUoW1wibWVudVwiXSk7ICAgICAgICAgIC8vIGNvbWUgZnJvbSBwYXRoIGluIHJvdXRpbmcgdHNcblx0fVxuXG5cdHB1YmxpYyBwcm9kdWN0KHByb2R1Y3RfaWQ9MCl7XG5cbiAgICAgICAgLy8gbGV0IG5hdmlnYXRpb25FeHRyYXM6IE5hdmlnYXRpb25FeHRyYXMgPSB7XG4gICAgICAgIC8vICAgICBxdWVyeVBhcmFtczoge1xuICAgICAgICAvLyAgICAgICAgIFwiaWRcIjogcHJvZHVjdF9pZFxuICAgICAgICAvLyAgICAgfVxuICAgICAgICAvLyB9O1xuICAgICAgICAvLyBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShuYXZpZ2F0aW9uRXh0cmFzKSk7XG4gICAgICAgIC8vIHRoaXMucm91dGVyLm5hdmlnYXRlKFtcInByb2R1Y3QvXCJdLCBuYXZpZ2F0aW9uRXh0cmFzKTtcbiAgICAgICAgdGhpcy5yb3V0ZXIubmF2aWdhdGUoW1wicHJvZHVjdC9cIixwcm9kdWN0X2lkXSk7XG4gICAgICAgIC8vIHRoaXMucm91dGVyLm5hdmlnYXRlQnlVcmwoJ3Byb2R1Y3QvJyArIHByb2R1Y3RfaWQpOyAgICAgICBcblx0fVxuXG5cdHB1YmxpYyBzZWFyY2hQaHJhc2U6IHN0cmluZztcbiAgICBcbiAgICBwdWJsaWMgb25TdWJtaXQodmFsdWUpIHtcblxuICAgICAgICAvLyBhbGVydChcIllvdSBhcmUgc2VhcmNoaW5nIGZvciBcIiArIHZhbHVlKTtcblxuICAgICAgICAvLyBmb3IodmFyIF9pID0gMDsgX2kgPCB0aGlzLm15SXRlbXMubGVuZ3RoOyBfaSsrKXtcblxuICAgICAgICB2YXIgeCA9IDA7XG4gICAgICAgIHZhciBvdXQgPSAwO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKFwiU2VhcmNoIDogXCIrdmFsdWUpXG4gICAgICAgIGNvbnNvbGUubG9nKFwidGhpcy5teUl0ZW1zLmxlbmd0aCA6IFwiK3RoaXMubXlJdGVtcy5sZW5ndGgpXG5cbiAgICAgICAgZm9yKHRoaXMuY291bnQ9MCA7IHRoaXMuY291bnQ8dGhpcy5teUl0ZW1zLmxlbmd0aCA7IHRoaXMuY291bnQrKyl7XG5cbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiY291bnQgOiBcIit0aGlzLmNvdW50KVxuICAgICAgICAgICAgeCArPSAxO1xuICAgICAgICAgICAgaWYodGhpcy5teUl0ZW1zW3RoaXMuY291bnRdLnRvTG93ZXJDYXNlKCkgPT0gdmFsdWUudG9Mb3dlckNhc2UoKSl7XG5cbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlNlYXJjaCA6IFwiKyB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgTG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJsb2NhbHNlYXJjaFwiLCB2YWx1ZS50b0xvd2VyQ2FzZSgpKTtcblxuICAgICAgICAgICAgICAgIHRoaXMuZXh0cmFjdERhdGFTZWFyY2goKTtcbiAgICAgICAgICAgICAgICBvdXQgPSAxO1xuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmKG91dD09MCAmJiB4KzEgPiB0aGlzLm15SXRlbXMubGVuZ3RoKXtcbiAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwieCA6IFwiK3gpXG4gICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcInRoaXMubXlJdGVtcy5sZW5ndGggOiBcIit0aGlzLm15SXRlbXMubGVuZ3RoKVxuICAgICAgICAgICAgICAgYWxlcnQoXCJObyBQcm9kdWN0IE5hbWUgOiBcIit2YWx1ZSlcblxuICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgfVxuXG4gICAgfVxuXG4gICAgb25TZWFyY2hMYXlvdXRMb2FkZWQoZXZlbnQpIHtcbiAgICAgICAgICAgIGV2ZW50Lm9iamVjdC5hbmRyb2lkLnNldEZvY3VzYWJsZUluVG91Y2hNb2RlKHRydWUpO1xuICAgICAgICBcbiAgICB9XG5cbiAgICBvblNlYXJjaEJhckxvYWRlZChldmVudCkge1xuICAgICAgICAgICAgZXZlbnQub2JqZWN0LmFuZHJvaWQuY2xlYXJGb2N1cygpO1xuICAgICAgICBcbiAgICB9XG5cbiAgICBjbGVhclRleHRmaWVsZEZvY3VzKGV2ZW50KXtcbiAgICBcdGV2ZW50LmxheW91dC5hbmRyb2lkLmRpc21pc3NTb2Z0SW5wdXQoKTtcbiAgICB9XG5cbn1cblxuICAgICJdfQ==